import{_ as t}from"../../chunks/preload-helper-08cc8e69.js";import{S as e,i as s,s as o,e as n,t as a,k as r,c,a as i,g as l,d,o as u,b as h,f,H as p,L as v,M as m,P as g,V as y,W as x,X as E,h as w,I as b,B as k}from"../../chunks/vendor-ad0fc7d4.js";import{g as j}from"../../chunks/navigation-2ffed81e.js";import{u as I}from"../../chunks/user-dcdcb249.js";import{A as _}from"../../chunks/Env-caf617d4.js";import"../../chunks/singletons-12a22614.js";function D(t){let e,s,o,y,x,E,w,b;return{c(){e=n("p"),s=n("button"),o=a("Update post"),y=r(),x=n("button"),E=a("Delete post"),this.h()},l(t){e=c(t,"P",{class:!0});var n=i(e);s=c(n,"BUTTON",{class:!0});var a=i(s);o=l(a,"Update post"),a.forEach(d),y=u(n),x=c(n,"BUTTON",{class:!0});var r=i(x);E=l(r,"Delete post"),r.forEach(d),n.forEach(d),this.h()},h(){h(s,"class","bg-blue-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(x,"class","bg-red-500 text-white font-bold py-2 px-4 rounded border-transparent"),h(e,"class","my-2 flex justify-center items-center gap-3")},m(n,a){f(n,e,a),p(e,s),p(s,o),p(e,y),p(e,x),p(x,E),w||(b=[v(s,"click",t[4]),v(x,"click",t[3])],w=!0)},p:m,d(t){t&&d(e),w=!1,g(b)}}}function T(t){let e,s,o,v,g,b,k,j,I,_,T,B,P,A,L,N,U,V=t[0].title+"",$=t[0].author.username+"",O=t[0].url+"",S=t[2]&&t[0].author.id===t[2].id&&D(t);return{c(){e=n("link"),s=r(),o=n("h1"),v=a(V),g=r(),b=n("p"),k=a("By: "),j=a($),I=r(),S&&S.c(),_=r(),T=n("div"),B=n("div"),P=n("a"),A=a(O),N=r(),U=new y,this.h()},l(t){const n=x('[data-svelte="svelte-1mlvvzv"]',document.head);e=c(n,"LINK",{rel:!0,href:!0}),n.forEach(d),s=u(t),o=c(t,"H1",{class:!0});var a=i(o);v=l(a,V),a.forEach(d),g=u(t),b=c(t,"P",{class:!0});var r=i(b);k=l(r,"By: "),j=l(r,$),r.forEach(d),I=u(t),S&&S.l(t),_=u(t),T=c(t,"DIV",{class:!0});var h=i(T);B=c(h,"DIV",{class:!0});var f=i(B);P=c(f,"A",{href:!0});var p=i(P);A=l(p,O),p.forEach(d),N=u(f),U=E(f),f.forEach(d),h.forEach(d),this.h()},h(){h(e,"rel","stylesheet"),h(e,"href","https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.4.x/dist/typography.min.css"),h(o,"class","text-center text-4xl mt-4"),h(b,"class","text-center mt-2"),h(P,"href",L=t[0].url),U.a=null,h(B,"class","prose lg:prose-xl"),h(T,"class","border border-gray-500 my-4 mx-8 p-6 rounded ")},m(n,a){p(document.head,e),f(n,s,a),f(n,o,a),p(o,v),f(n,g,a),f(n,b,a),p(b,k),p(b,j),f(n,I,a),S&&S.m(n,a),f(n,_,a),f(n,T,a),p(T,B),p(B,P),p(P,A),p(B,N),U.m(t[1],B)},p(t,[e]){1&e&&V!==(V=t[0].title+"")&&w(v,V),1&e&&$!==($=t[0].author.username+"")&&w(j,$),t[2]&&t[0].author.id===t[2].id?S?S.p(t,e):(S=D(t),S.c(),S.m(_.parentNode,_)):S&&(S.d(1),S=null),1&e&&O!==(O=t[0].url+"")&&w(A,O),1&e&&L!==(L=t[0].url)&&h(P,"href",L),2&e&&U.p(t[1])},i:m,o:m,d(t){d(e),t&&d(s),t&&d(o),t&&d(g),t&&d(b),t&&d(I),S&&S.d(t),t&&d(_),t&&d(T)}}}var B=function(t,e,s,o){return new(s||(s=Promise))((function(n,a){function r(t){try{i(o.next(t))}catch(e){a(e)}}function c(t){try{i(o.throw(t))}catch(e){a(e)}}function i(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,c)}i((o=o.apply(t,e||[])).next())}))};const P=({page:{params:t},fetch:e})=>B(void 0,void 0,void 0,(function*(){const{slug:s}=t,o=yield e("http://localhost:1337/posts/"+s);if(404===o.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}return{props:{post:yield o.json()}}}));function A(e,s,o){let n;b(e,I,(t=>o(2,n=t)));var a=this&&this.__awaiter||function(t,e,s,o){return new(s||(s=Promise))((function(n,a){function r(t){try{i(o.next(t))}catch(e){a(e)}}function c(t){try{i(o.throw(t))}catch(e){a(e)}}function i(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,c)}i((o=o.apply(t,e||[])).next())}))};let{post:r}=s,c=r.content;k((()=>a(void 0,void 0,void 0,(function*(){const e=(yield t((()=>import("../../chunks/vendor-ad0fc7d4.js").then((function(t){return t.m}))),[])).default;o(1,c=e(r.content))}))));return e.$$set=t=>{"post"in t&&o(0,r=t.post)},[r,c,n,function(){var t,e,s,o;return a(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void j("/login");const n=yield fetch(`${_}/posts/`+r.id,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token")}});if(n.ok)j("/");else{const a=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==a?void 0:a.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(a.message[0].messages[0].message)}}))},()=>j("/blog/new?edit="+r.id)]}class L extends e{constructor(t){super(),s(this,t,A,T,o,{post:0})}}export{L as default,P as load};
