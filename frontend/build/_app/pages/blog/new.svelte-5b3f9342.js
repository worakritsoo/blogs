import{S as t,i as e,s,e as o,t as n,k as i,c as a,a as r,g as c,d as l,o as d,b as u,f as v,H as f,N as p,L as h,R as m,M as g,P as y,I as E,B as I,U as x}from"../../chunks/vendor-ad0fc7d4.js";import{A as b}from"../../chunks/Env-caf617d4.js";import{u as T}from"../../chunks/user-dcdcb249.js";import{g as j}from"../../chunks/navigation-2ffed81e.js";import"../../chunks/singletons-12a22614.js";function w(t){let e,s,E,I,x,b,T,j,w,k,A,S,$,D,L,B,P,N,V,O,U,C,M,H,R,z,J;return{c(){e=o("div"),s=o("form"),E=o("div"),I=o("label"),x=n("Title"),b=i(),T=o("input"),j=i(),w=o("div"),k=o("label"),A=n("Description"),S=i(),$=o("input"),D=i(),L=o("div"),B=o("label"),P=n("Content"),N=i(),V=o("textarea"),O=i(),U=o("div"),C=o("button"),M=n("Submit"),H=i(),R=o("div"),this.h()},l(t){e=a(t,"DIV",{class:!0});var o=r(e);s=a(o,"FORM",{class:!0});var n=r(s);E=a(n,"DIV",{class:!0});var i=r(E);I=a(i,"LABEL",{for:!0,class:!0});var u=r(I);x=c(u,"Title"),u.forEach(l),b=d(i),T=a(i,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),i.forEach(l),j=d(n),w=a(n,"DIV",{class:!0});var v=r(w);k=a(v,"LABEL",{for:!0,class:!0});var f=r(k);A=c(f,"Description"),f.forEach(l),S=d(v),$=a(v,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),v.forEach(l),D=d(n),L=a(n,"DIV",{class:!0});var p=r(L);B=a(p,"LABEL",{for:!0,class:!0});var h=r(B);P=c(h,"Content"),h.forEach(l),N=d(p),V=a(p,"TEXTAREA",{rows:!0,placeholder:!0,id:!0,class:!0}),r(V).forEach(l),p.forEach(l),O=d(n),U=a(n,"DIV",{class:!0});var m=r(U);C=a(m,"BUTTON",{class:!0,type:!0});var g=r(C);M=c(g,"Submit"),g.forEach(l),m.forEach(l),n.forEach(l),H=d(o),R=a(o,"DIV",{class:!0}),r(R).forEach(l),o.forEach(l),this.h()},h(){u(I,"for","title"),u(I,"class","svelte-1gr50x2"),u(T,"type","text"),u(T,"placeholder","Enter title"),u(T,"id","title"),u(T,"class","svelte-1gr50x2"),u(E,"class","my-1"),u(k,"for","description"),u(k,"class","svelte-1gr50x2"),u($,"type","text"),u($,"placeholder","Enter description"),u($,"id","description"),u($,"class","svelte-1gr50x2"),u(w,"class","my-1"),u(B,"for","title"),u(B,"class","svelte-1gr50x2"),u(V,"rows",5),u(V,"placeholder","Enter content"),u(V,"id","content"),u(V,"class","svelte-1gr50x2"),u(L,"class","my-1"),u(C,"class","submit svelte-1gr50x2"),u(C,"type","submit"),u(U,"class","my-2"),u(s,"class","my-4 mx-auto container p-4"),u(R,"class","prose md:prose-md w-full"),u(e,"class","md:flex")},m(o,n){v(o,e,n),f(e,s),f(s,E),f(E,I),f(I,x),f(E,b),f(E,T),p(T,t[1]),f(s,j),f(s,w),f(w,k),f(k,A),f(w,S),f(w,$),p($,t[2]),f(s,D),f(s,L),f(L,B),f(B,P),f(L,N),f(L,V),p(V,t[0]),f(s,O),f(s,U),f(U,C),f(C,M),f(e,H),f(e,R),R.innerHTML=t[3],z||(J=[h(T,"input",t[6]),h($,"input",t[7]),h(V,"input",t[8]),h(s,"submit",m(t[4]))],z=!0)},p(t,[e]){2&e&&T.value!==t[1]&&p(T,t[1]),4&e&&$.value!==t[2]&&p($,t[2]),1&e&&p(V,t[0]),8&e&&(R.innerHTML=t[3])},i:g,o:g,d(t){t&&l(e),z=!1,y(J)}}}var k=function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function r(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,r)}c((o=o.apply(t,e||[])).next())}))};const A=({fetch:t,page:{query:e}})=>k(void 0,void 0,void 0,(function*(){const s=e.get("edit");if(s){const e=yield t(`${b}/posts/`+s);if(404===e.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}{const t=yield e.json();return{props:{editId:s,title:t.title,content:t.content,description:t.description}}}}return{props:{}}}));function S(t,e,s){let o,n;E(t,T,(t=>s(9,n=t)));var i=this&&this.__awaiter||function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function r(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,r)}c((o=o.apply(t,e||[])).next())}))};let{editId:a}=e,{title:r=""}=e,{description:c=""}=e,{content:l=""}=e;return I((()=>{n||j("/login")})),t.$$set=t=>{"editId"in t&&s(5,a=t.editId),"title"in t&&s(1,r=t.title),"description"in t&&s(2,c=t.description),"content"in t&&s(0,l=t.content)},t.$$.update=()=>{1&t.$$.dirty&&s(3,o=x(l))},[l,r,c,o,function(){var t,e,s,o;return i(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void j("/login");if(a)return void function(){var t,e,s,o;i(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void j("/login");const n=yield fetch(`${b}/posts/`+a,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:r,description:c,content:l})});if(n.ok){const t=yield n.json();j("/blog/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))}();const n=yield fetch(`${b}/posts`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:r,description:c,content:l})});if(n.ok){const t=yield n.json();j("/blog/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))},a,function(){r=this.value,s(1,r)},function(){c=this.value,s(2,c)},function(){l=this.value,s(0,l)}]}class $ extends t{constructor(t){super(),e(this,t,S,w,s,{editId:5,title:1,description:2,content:0})}}export{$ as default,A as load};
