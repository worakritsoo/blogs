import{S as t,i as e,s,k as o,e as n,t as i,U as a,d as l,o as r,c,a as d,g as u,b as v,f as p,H as f,N as h,L as m,R as g,M as y,P as E,I,B as x,V as T}from"../../chunks/vendor-026e69f7.js";import{A as b,u as w}from"../../chunks/Env-828c620c.js";import{g as j}from"../../chunks/navigation-2ffed81e.js";import"../../chunks/singletons-12a22614.js";function k(t){let e,s,I,x,T,b,w,j,k,A,L,D,S,$,U,B,P,V,N,O,C,M,H,R,z,J,_,q,F,X,G,K,Q,W,Y;return document.title=e=t[1],{c(){s=o(),I=n("div"),x=n("form"),T=n("div"),b=n("label"),w=i("Title"),j=o(),k=n("input"),A=o(),L=n("div"),D=n("label"),S=i("Url"),$=o(),U=n("input"),B=o(),P=n("div"),V=n("label"),N=i("Description"),O=o(),C=n("input"),M=o(),H=n("div"),R=n("label"),z=i("Content"),J=o(),_=n("textarea"),q=o(),F=n("div"),X=n("button"),G=i("Submit"),K=o(),Q=n("div"),this.h()},l(t){a('[data-svelte="svelte-1258swp"]',document.head).forEach(l),s=r(t),I=c(t,"DIV",{class:!0});var e=d(I);x=c(e,"FORM",{class:!0});var o=d(x);T=c(o,"DIV",{class:!0});var n=d(T);b=c(n,"LABEL",{for:!0,class:!0});var i=d(b);w=u(i,"Title"),i.forEach(l),j=r(n),k=c(n,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),n.forEach(l),A=r(o),L=c(o,"DIV",{class:!0});var v=d(L);D=c(v,"LABEL",{for:!0,class:!0});var p=d(D);S=u(p,"Url"),p.forEach(l),$=r(v),U=c(v,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),v.forEach(l),B=r(o),P=c(o,"DIV",{class:!0});var f=d(P);V=c(f,"LABEL",{for:!0,class:!0});var h=d(V);N=u(h,"Description"),h.forEach(l),O=r(f),C=c(f,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),f.forEach(l),M=r(o),H=c(o,"DIV",{class:!0});var m=d(H);R=c(m,"LABEL",{for:!0,class:!0});var g=d(R);z=u(g,"Content"),g.forEach(l),J=r(m),_=c(m,"TEXTAREA",{rows:!0,placeholder:!0,id:!0,class:!0}),d(_).forEach(l),m.forEach(l),q=r(o),F=c(o,"DIV",{class:!0});var y=d(F);X=c(y,"BUTTON",{class:!0,type:!0});var E=d(X);G=u(E,"Submit"),E.forEach(l),y.forEach(l),o.forEach(l),K=r(e),Q=c(e,"DIV",{class:!0}),d(Q).forEach(l),e.forEach(l),this.h()},h(){v(b,"for","title"),v(b,"class","svelte-1gr50x2"),v(k,"type","text"),v(k,"placeholder","Enter title"),v(k,"id","title"),v(k,"class","svelte-1gr50x2"),v(T,"class","my-1"),v(D,"for","url"),v(D,"class","svelte-1gr50x2"),v(U,"type","url"),v(U,"placeholder","Enter Url"),v(U,"id","url"),v(U,"class","svelte-1gr50x2"),v(L,"class","my-1"),v(V,"for","description"),v(V,"class","svelte-1gr50x2"),v(C,"type","text"),v(C,"placeholder","Enter description"),v(C,"id","description"),v(C,"class","svelte-1gr50x2"),v(P,"class","my-1"),v(R,"for","title"),v(R,"class","svelte-1gr50x2"),v(_,"rows",5),v(_,"placeholder","Enter content"),v(_,"id","content"),v(_,"class","svelte-1gr50x2"),v(H,"class","my-1"),v(X,"class","submit svelte-1gr50x2"),v(X,"type","submit"),v(F,"class","my-2"),v(x,"class","my-4 mx-auto container p-4"),v(Q,"class","prose md:prose-md w-full"),v(I,"class","md:flex")},m(e,o){p(e,s,o),p(e,I,o),f(I,x),f(x,T),f(T,b),f(b,w),f(T,j),f(T,k),h(k,t[1]),f(x,A),f(x,L),f(L,D),f(D,S),f(L,$),f(L,U),h(U,t[3]),f(x,B),f(x,P),f(P,V),f(V,N),f(P,O),f(P,C),h(C,t[2]),f(x,M),f(x,H),f(H,R),f(R,z),f(H,J),f(H,_),h(_,t[0]),f(x,q),f(x,F),f(F,X),f(X,G),f(I,K),f(I,Q),Q.innerHTML=t[4],W||(Y=[m(k,"input",t[7]),m(U,"input",t[8]),m(C,"input",t[9]),m(_,"input",t[10]),m(x,"submit",g(t[5]))],W=!0)},p(t,[s]){2&s&&e!==(e=t[1])&&(document.title=e),2&s&&k.value!==t[1]&&h(k,t[1]),8&s&&h(U,t[3]),4&s&&C.value!==t[2]&&h(C,t[2]),1&s&&h(_,t[0]),16&s&&(Q.innerHTML=t[4])},i:y,o:y,d(t){t&&l(s),t&&l(I),W=!1,E(Y)}}}var A=function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{r(o.next(t))}catch(e){i(e)}}function l(t){try{r(o.throw(t))}catch(e){i(e)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,l)}r((o=o.apply(t,e||[])).next())}))};const L=({fetch:t,page:{query:e}})=>A(void 0,void 0,void 0,(function*(){const s=e.get("edit");if(s){const e=yield t(`${b}/posts/`+s);if(404===e.status){return{status:404,error:new Error(`The post with ID ${s} was not found`)}}{const t=yield e.json();return{props:{editId:s,title:t.title,url:t.url,content:t.content,description:t.description}}}}return{props:{}}}));function D(t,e,s){let o,n;I(t,w,(t=>s(11,n=t)));var i=this&&this.__awaiter||function(t,e,s,o){return new(s||(s=Promise))((function(n,i){function a(t){try{r(o.next(t))}catch(e){i(e)}}function l(t){try{r(o.throw(t))}catch(e){i(e)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,l)}r((o=o.apply(t,e||[])).next())}))};let{editId:a}=e,{title:l=""}=e,{description:r=""}=e,{content:c=""}=e,{url:d=""}=e;return x((()=>{n||j("/login")})),t.$$set=t=>{"editId"in t&&s(6,a=t.editId),"title"in t&&s(1,l=t.title),"description"in t&&s(2,r=t.description),"content"in t&&s(0,c=t.content),"url"in t&&s(3,d=t.url)},t.$$.update=()=>{1&t.$$.dirty&&s(4,o=T(c))},[c,l,r,d,o,function(){var t,e,s,o;return i(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void j("/login");if(a)return void function(){var t,e,s,o;i(this,void 0,void 0,(function*(){if(!localStorage.getItem("token"))return void j("/login");const n=yield fetch(`${b}/posts/`+a,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:l,description:r,content:c,url:d})});if(n.ok){const t=yield n.json();j("/blog/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))}();const n=yield fetch(`${b}/posts`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({title:l,description:r,content:c,url:d})});if(n.ok){const t=yield n.json();j("/blog/"+t.id)}else{const i=yield n.json();(null===(o=null===(s=null===(e=null===(t=null==i?void 0:i.message)||void 0===t?void 0:t[0])||void 0===e?void 0:e.messages)||void 0===s?void 0:s[0])||void 0===o?void 0:o.message)&&alert(i.message[0].messages[0].message)}}))},a,function(){l=this.value,s(1,l)},function(){d=this.value,s(3,d)},function(){r=this.value,s(2,r)},function(){c=this.value,s(0,c)}]}class S extends t{constructor(t){super(),e(this,t,D,k,s,{editId:6,title:1,description:2,content:0,url:3})}}export{S as default,L as load};
